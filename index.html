<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’Œ San ValentÃ­n</title>
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=EB+Garamond:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">
<style>

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VARIABLES & RESET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --r: #6B21A8;
  --r2: #7C3AED;
  --rosa: #A855F7;
  --oro: #9333EA;
  --oro2: #C084FC;
  --marfil: #FAF5FF;
  --papel: #FDF8FF;
  --texto: #1E1030;
  --texto2: #4B2068;
  --sombra-r: rgba(107,33,168,.18);
  --sombra-oro: rgba(147,51,234,.12);
}

*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

html { scroll-behavior: smooth; }

body {
  background: var(--marfil);
  font-family: 'EB Garamond', serif;
  min-height: 100vh;
  overflow-x: hidden;
  color: var(--texto);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS DE FONDO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bg {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TEXTURA DE FONDO (ruido sutil)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    radial-gradient(ellipse 80% 60% at 20% 10%, rgba(192,132,252,.10) 0%, transparent 60%),
    radial-gradient(ellipse 60% 80% at 80% 90%, rgba(107,33,168,.08) 0%, transparent 60%);
  pointer-events: none;
  z-index: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PANTALLA 1 â€” SOBRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pantalla-sobre {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 28px;
  z-index: 10;
  transition: opacity .8s ease, transform .8s ease;
}

#pantalla-sobre.saliendo {
  opacity: 0;
  transform: scale(.92);
  pointer-events: none;
}

/* Sello decorativo arriba */
.sello {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: 2px solid var(--rosa);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  color: var(--rosa);
  background: rgba(253,248,255,.9);
  box-shadow: 0 0 0 4px rgba(168,85,247,.15);
  animation: girar-lento 12s linear infinite;
  position: relative;
}

.sello::after {
  content: 'Â· S A N  V A L E N T Ã N Â·';
  position: absolute;
  font-size: 6px;
  letter-spacing: .22em;
  color: var(--rosa);
  width: 100%;
  text-align: center;
  bottom: -22px;
  font-family: 'EB Garamond', serif;
  white-space: nowrap;
}

@keyframes girar-lento {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

/* El sobre */
.sobre-contenedor {
  perspective: 1000px;
}

.sobre {
  width: 320px;
  height: 220px;
  position: relative;
  cursor: pointer;
  transform-style: preserve-3d;
  transition: transform .2s ease;
  filter: drop-shadow(0 16px 40px rgba(107,33,168,.28));
}

.sobre:hover {
  transform: translateY(-6px) rotateX(4deg);
  filter: drop-shadow(0 24px 48px rgba(107,33,168,.38));
}

/* Cuerpo del sobre */
.s-cuerpo {
  position: absolute;
  inset: 0;
  background: linear-gradient(160deg, #f3e8ff 0%, #e9d5ff 100%);
  border-radius: 4px 4px 14px 14px;
  border: 1.5px solid #c084fc;
  overflow: hidden;
}

/* TriÃ¡ngulos laterales y base */
.s-tri-izq, .s-tri-der, .s-tri-base {
  position: absolute;
  bottom: 0;
  width: 0; height: 0;
}

.s-tri-izq {
  left: 0;
  border-bottom: 110px solid #d8b4fe;
  border-right: 160px solid transparent;
}

.s-tri-der {
  right: 0;
  border-bottom: 110px solid #d8b4fe;
  border-left: 160px solid transparent;
}

.s-tri-base {
  left: 0; right: 0; bottom: 0;
  width: 100%;
  height: 110px;
  background: linear-gradient(175deg, #e9d5ff, #c084fc);
  clip-path: polygon(0 100%, 50% 0, 100% 100%);
}

/* Icono central */
.s-icono {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 56px;
  z-index: 2;
  padding-bottom: 20px;
  user-select: none;
  animation: latido 1.6s ease-in-out infinite;
}

@keyframes latido {
  0%,100% { transform: scale(1); }
  30%      { transform: scale(1.12); }
  60%      { transform: scale(.96); }
}

/* Tapa del sobre */
.s-tapa {
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 130px;
  background: linear-gradient(150deg, #a855f7 0%, #7c3aed 100%);
  clip-path: polygon(0 0, 50% 62%, 100% 0);
  transform-origin: top center;
  transition: transform .85s cubic-bezier(.4,0,.15,1);
  z-index: 3;
  border-bottom: 1px solid #9333ea;
}

.sobre.abierto .s-tapa {
  transform: rotateX(-180deg);
}

/* Carta mini saliendo */
.s-carta-mini {
  position: absolute;
  bottom: -4px;
  left: 50%;
  transform: translateX(-50%);
  width: 200px;
  height: 0;
  background: var(--papel);
  border: 1px solid #c084fc;
  border-bottom: none;
  border-radius: 2px 2px 0 0;
  box-shadow: 0 -4px 12px rgba(0,0,0,.06);
  transition: height .6s .4s cubic-bezier(.4,0,.2,1);
  z-index: 1;
  overflow: hidden;
}

.sobre.abierto .s-carta-mini {
  height: 80px;
}

.s-carta-mini-lineas {
  padding: 14px 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  opacity: 0;
  transition: opacity .4s .9s;
}

.sobre.abierto .s-carta-mini-lineas { opacity: 1; }

.s-linea {
  height: 2px;
  border-radius: 1px;
  background: linear-gradient(to right, #a855f7, transparent);
}
.s-linea:nth-child(1) { width: 80%; }
.s-linea:nth-child(2) { width: 60%; }
.s-linea:nth-child(3) { width: 70%; }

/* Hint */
.hint {
  font-family: 'EB Garamond', serif;
  font-style: italic;
  font-size: 15px;
  color: var(--rosa);
  letter-spacing: .06em;
  opacity: 0;
  animation: aparecer .8s 1s forwards;
  text-align: center;
}

@keyframes aparecer {
  from { opacity:0; transform: translateY(6px); }
  to   { opacity:1; transform: translateY(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PANTALLA 2 â€” CARTA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#pantalla-carta {
  position: relative;
  z-index: 5;
  display: none;
  flex-direction: column;
  align-items: center;
  padding: 60px 20px 100px;
  min-height: 100vh;
}

#pantalla-carta.activa {
  display: flex;
}

/* Cabecera ornamental */
.cabecera {
  text-align: center;
  margin-bottom: 44px;
}

.fecha {
  font-family: 'EB Garamond', serif;
  font-size: 13px;
  letter-spacing: .28em;
  color: var(--oro);
  text-transform: uppercase;
  opacity: 0;
  animation: subir .6s .2s forwards;
}

.titulo-principal {
  font-family: 'Libre Baskerville', serif;
  font-size: clamp(34px, 6vw, 58px);
  font-weight: 700;
  color: var(--r);
  line-height: 1.1;
  margin: 10px 0 6px;
  opacity: 0;
  animation: subir .7s .35s forwards;
}

.titulo-sub {
  font-family: 'Libre Baskerville', serif;
  font-style: italic;
  font-size: clamp(15px, 2.5vw, 20px);
  color: var(--oro);
  letter-spacing: .04em;
  opacity: 0;
  animation: subir .6s .5s forwards;
}

.divider {
  display: flex;
  align-items: center;
  gap: 14px;
  margin: 28px 0;
  opacity: 0;
  animation: subir .6s .65s forwards;
}

.divider-line {
  flex: 1;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--rosa), transparent);
  max-width: 160px;
}

.divider-ornamento {
  font-size: 18px;
  color: var(--oro2);
  letter-spacing: .3em;
}

/* Papel carta */
.papel {
  background: var(--papel);
  max-width: 680px;
  width: 100%;
  border-radius: 2px;
  padding: 56px 60px;
  position: relative;
  box-shadow:
    0 1px 2px rgba(0,0,0,.04),
    0 4px 16px rgba(107,33,168,.12),
    0 24px 64px rgba(107,33,168,.09),
    inset 0 0 0 1px rgba(168,85,247,.15);
  opacity: 0;
  animation: subir .9s .8s forwards;
}

/* LÃ­neas de cuaderno sutiles */
.papel::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(
    to bottom,
    transparent,
    transparent 31px,
    rgba(168,85,247,.14) 31px,
    rgba(168,85,247,.14) 32px
  );
  border-radius: 2px;
  pointer-events: none;
}

/* Margen izquierdo */
.papel::after {
  content: '';
  position: absolute;
  left: 44px;
  top: 0; bottom: 0;
  width: 1px;
  background: rgba(168,85,247,.2);
}

.parrafo {
  font-size: clamp(16px, 2vw, 18.5px);
  line-height: 2;
  color: var(--texto);
  font-weight: 300;
  margin-bottom: 28px;
  position: relative;
  z-index: 1;
}

.parrafo em {
  font-style: italic;
  color: var(--r2);
  font-weight: 400;
}

.parrafo strong {
  font-weight: 700;
  color: var(--texto);
}

.saludo {
  font-family: 'Libre Baskerville', serif;
  font-style: italic;
  font-size: clamp(17px, 2.5vw, 20px);
  color: var(--r);
  margin-bottom: 32px;
  position: relative;
  z-index: 1;
}

.firma-bloque {
  margin-top: 40px;
  text-align: right;
  position: relative;
  z-index: 1;
}

.firma-texto {
  font-family: 'Libre Baskerville', serif;
  font-style: italic;
  font-size: 24px;
  color: var(--r);
  margin-bottom: 4px;
}

.firma-sub {
  font-size: 13px;
  color: var(--oro);
  letter-spacing: .16em;
  text-transform: uppercase;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECCIÃ“N DE TARJETAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.seccion-tarjetas {
  max-width: 780px;
  width: 100%;
  margin-top: 56px;
  opacity: 0;
  animation: subir .8s 1.4s forwards;
}

.seccion-titulo {
  font-family: 'Libre Baskerville', serif;
  font-size: 13px;
  letter-spacing: .28em;
  color: var(--oro);
  text-transform: uppercase;
  text-align: center;
  margin-bottom: 28px;
}

.tarjetas-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}

.tarjeta {
  background: var(--papel);
  border: 1px solid rgba(168,85,247,.25);
  border-radius: 3px;
  padding: 28px 24px;
  text-align: center;
  box-shadow: 0 4px 16px rgba(107,33,168,.07);
  transition: transform .25s ease, box-shadow .25s ease;
  cursor: default;
  position: relative;
  overflow: hidden;
}

.tarjeta::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,.6) 0%, transparent 50%);
  pointer-events: none;
}

.tarjeta:hover {
  transform: translateY(-5px) rotate(.3deg);
  box-shadow: 0 12px 36px rgba(107,33,168,.16);
}

.tarjeta-emoji {
  font-size: 36px;
  margin-bottom: 12px;
  display: block;
  animation: flotar 3s ease-in-out infinite;
}

.tarjeta:nth-child(2) .tarjeta-emoji { animation-delay: -.6s; }
.tarjeta:nth-child(3) .tarjeta-emoji { animation-delay: -1.2s; }

@keyframes flotar {
  0%,100% { transform: translateY(0); }
  50%      { transform: translateY(-5px); }
}

.tarjeta-titulo {
  font-family: 'Libre Baskerville', serif;
  font-size: 15px;
  font-weight: 700;
  color: var(--r);
  margin-bottom: 8px;
}

.tarjeta-texto {
  font-size: 14px;
  line-height: 1.7;
  color: var(--texto2);
  font-style: italic;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTONES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.botones {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
  justify-content: center;
  margin-top: 48px;
  opacity: 0;
  animation: subir .7s 1.8s forwards;
}

.btn {
  font-family: 'EB Garamond', serif;
  font-size: 15px;
  letter-spacing: .12em;
  text-transform: uppercase;
  padding: 14px 36px;
  border-radius: 40px;
  border: none;
  cursor: pointer;
  transition: transform .2s, box-shadow .2s, background .2s;
  position: relative;
  overflow: hidden;
}

.btn::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(255,255,255,.0);
  transition: background .2s;
}

.btn:hover::after { background: rgba(255,255,255,.12); }
.btn:hover { transform: translateY(-3px); }
.btn:active { transform: translateY(0); }

.btn-rojo {
  background: var(--r);
  color: #fff;
  box-shadow: 0 4px 20px rgba(107,33,168,.4);
}

.btn-rojo:hover { box-shadow: 0 8px 32px rgba(107,33,168,.55); }

.btn-oro {
  background: transparent;
  color: var(--r);
  border: 1.5px solid var(--r);
  box-shadow: 0 2px 10px rgba(107,33,168,.1);
}

.btn-gris {
  background: transparent;
  color: var(--rosa);
  border: 1.5px solid var(--rosa);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast {
  position: fixed;
  bottom: 36px;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: var(--r);
  color: #fff;
  font-family: 'EB Garamond', serif;
  font-size: 16px;
  letter-spacing: .06em;
  padding: 16px 32px;
  border-radius: 50px;
  box-shadow: 0 8px 32px rgba(107,33,168,.45);
  pointer-events: none;
  z-index: 999;
  transition: transform .55s cubic-bezier(.4,0,.2,1);
  white-space: nowrap;
}

.toast.show { transform: translateX(-50%) translateY(0); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMACIONES UTILITARIAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes subir {
  from { opacity:0; transform: translateY(22px); }
  to   { opacity:1; transform: translateY(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 600px) {
  .papel { padding: 36px 28px; }
  .papel::after { left: 24px; }
  .sobre { width: 280px; height: 192px; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLLBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--marfil); }
::-webkit-scrollbar-thumb { background: #a855f7; border-radius: 3px; }

</style>
</head>
<body>

<canvas id="bg"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PANTALLA 1: SOBRE â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="pantalla-sobre">
  <div class="sello">ğŸ’œ</div>

  <div class="sobre-contenedor" onclick="abrirSobre()">
    <div class="sobre" id="sobre">
      <div class="s-cuerpo">
        <div class="s-tri-izq"></div>
        <div class="s-tri-der"></div>
        <div class="s-tri-base"></div>
        <div class="s-icono">ğŸ’œ</div>
      </div>
      <div class="s-carta-mini">
        <div class="s-carta-mini-lineas">
          <div class="s-linea"></div>
          <div class="s-linea"></div>
          <div class="s-linea"></div>
        </div>
      </div>
      <div class="s-tapa"></div>
    </div>
  </div>

  <p class="hint">Haz clic para abrir</p>
</section>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PANTALLA 2: CARTA â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="pantalla-carta">

  <header class="cabecera">
    <p class="fecha">14 de Febrero Â· 2026</p>
    <h1 class="titulo-principal">Feliz San ValentÃ­n</h1>
    <p class="titulo-sub">Un mensaje de Zadu</p>
    <div class="divider">
      <div class="divider-line"></div>
      <span class="divider-ornamento">â§ âœ¦ â§</span>
      <div class="divider-line"></div>
    </div>
  </header>

  <article class="papel">
    <p class="saludo">Para Bitter,</p>

      <p class="parrafo">
      SÃ© que no soy de las personas que anda diciendo estas cosas todo el tiempo,
      pero hoy es una buena excusa para decirte que <em>me alegra mucho tenerte cerca.</em>
    </p>

    <p class="parrafo">
      No todo el mundo se queda. Y tÃº te has quedado. Eso dice mÃ¡s de ti que
      cualquier cosa que yo pudiera escribir aquÃ­. <strong>Gracias por eso.</strong>
    </p>

    <p class="parrafo">
      No tengo muchas formas de expresarlo, pero si estÃ¡s leyendo esto es porque
      te lo mereces y punto. <em>Feliz San ValentÃ­n.</em>
    </p>

    <div class="firma-bloque">
      <p class="firma-texto">â€” Zadu</p>
    </div>
  </article>

  <!-- Tarjetas de gratitud -->
  <div class="seccion-tarjetas">
    <div class="tarjetas-grid">
      <div class="tarjeta">
        <span class="tarjeta-emoji">ğŸŒŸ</span>
        <p class="tarjeta-titulo">Tu luz</p>
        <p class="tarjeta-texto">Tienes una energÃ­a que contagia</p>
      </div>
      <div class="tarjeta">
        <span class="tarjeta-emoji">ğŸ¤</span>
        <p class="tarjeta-titulo">Tu lealtad</p>
        <p class="tarjeta-texto">En las buenas y en las malas, siempre has estado presente.</p>
      </div>
      <div class="tarjeta">
        <span class="tarjeta-emoji">ğŸ˜‚</span>
        <p class="tarjeta-titulo">Tu humor</p>
        <p class="tarjeta-texto">Hemos pasado por muchos momentos donde las risas nunca faltaron</p>
      </div>
    </div>
  </div>

  <!-- Botones -->
  <div class="botones">
    <button class="btn btn-gris" onclick="volver()">â†© Ver sobre</button>
  </div>

</section>

<!-- Toast -->


<script>

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS â€” PARTÃCULAS FLOTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const canvas = document.getElementById('bg');
const ctx    = canvas.getContext('2d');

let W, H, particulas = [];

function resize() {
  W = canvas.width  = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize', resize);

const EMOJIS = ['ğŸ’œ', 'âœ¦', 'â™¡', 'Â·', 'â§', 'âœ¿', 'â˜…', 'â¬¡'];

class Particula {
  constructor(opts = {}) {
    const exp = opts.explosion || false;
    this.exp  = exp;
    this.x    = exp ? W/2 + (Math.random()-.5)*240 : Math.random()*W;
    this.y    = exp ? H/2 + (Math.random()-.5)*180 : -30;
    this.e    = EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
    this.s    = exp ? 12 + Math.random()*26 : 9 + Math.random()*16;
    this.vy   = exp ? -(1.5 + Math.random()*3.5) : .45 + Math.random()*1.1;
    this.vx   = (Math.random()-.5) * (exp ? 4 : .9);
    this.a    = exp ? 1 : .25 + Math.random()*.45;
    this.r    = Math.random()*Math.PI*2;
    this.rv   = (Math.random()-.5)*.035;
    this.vida = 1;
  }
  tick() {
    this.y += this.vy;
    this.x += this.vx;
    this.r += this.rv;
    if (this.exp) { this.vy += .08; this.vida -= .016; this.a = this.vida; }
  }
  draw() {
    ctx.save();
    ctx.globalAlpha = Math.max(0, this.a);
    ctx.translate(this.x, this.y);
    ctx.rotate(this.r);
    ctx.font = `${this.s}px serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(this.e, 0, 0);
    ctx.restore();
  }
  muerta() { return this.exp ? this.vida <= 0 : this.y > H + 50; }
}

(function loop() {
  ctx.clearRect(0, 0, W, H);
  if (Math.random() < .055) particulas.push(new Particula());
  particulas = particulas.filter(p => !p.muerta());
  particulas.forEach(p => { p.tick(); p.draw(); });
  requestAnimationFrame(loop);
})();

function spawnExplosion(n = 50) {
  for (let i = 0; i < n; i++) particulas.push(new Particula({ explosion: true }));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LÃ“GICA DEL SOBRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let sobreAbierto = false;

function abrirSobre() {
  if (sobreAbierto) return;
  sobreAbierto = true;

  const sobre = document.getElementById('sobre');
  const pantalla1 = document.getElementById('pantalla-sobre');
  const pantalla2 = document.getElementById('pantalla-carta');

  // 1. Abrir tapa
  sobre.classList.add('abierto');

  // 2. PequeÃ±a explosiÃ³n de confeti
  setTimeout(() => spawnExplosion(30), 600);

  // 3. TransiciÃ³n de pantalla
  setTimeout(() => {
    pantalla1.classList.add('saliendo');
    pantalla2.classList.add('activa');
    spawnExplosion(40);
  }, 1300);

  // 4. Ocultar pantalla 1 completamente
  setTimeout(() => {
    pantalla1.style.display = 'none';
  }, 2100);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTONES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function explosionAmor() {
  spawnExplosion(80);
  mostrarToast('Â¡Enviado con todo el amor del mundo! ğŸ’œ');
}

function lluvia() {
  for (let i = 0; i < 10; i++) {
    setTimeout(() => {
      for (let j = 0; j < 18; j++) particulas.push(new Particula());
    }, i * 90);
  }
}

function volver() {
  const pantalla1 = document.getElementById('pantalla-sobre');
  const pantalla2 = document.getElementById('pantalla-carta');
  sobreAbierto = false;

  document.getElementById('sobre').classList.remove('abierto');

  pantalla2.classList.remove('activa');
  pantalla1.style.display = 'flex';
  pantalla1.classList.remove('saliendo');

  window.scrollTo(0, 0);
}

function mostrarToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3500);
}

</script>
</body>
</html>